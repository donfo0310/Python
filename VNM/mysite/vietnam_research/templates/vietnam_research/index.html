{% load static %}
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>VNMビューア</title>

    <!-- css -->
    <link rel="stylesheet" href="{% static 'vietnam_research/css/style.css' %}"> 

    <!-- D3.js -->
    <script src="https://d3js.org/d3.v4.min.js" charset="utf-8"></script>
    <script src="https://d3js.org/d3-path.v1.min.js" charset="utf-8"></script>
    <script src="{% static 'vietnam_research/js/radarChart.js' %}" charset="utf-8"></script>

</head>
<body>
    
    <h1>ここは非表示</h1>

    <!-- Django to Javascript -->
    <script>
        var industry1_name = [];
        var cnt_agg_by_industry = [];
        var cap_agg_by_industry = [];
    </script>
    {% for i in industry %}
        <script>
            industry1_name.push("{{ i.industry1 }}")
            cnt_agg_by_industry.push(Math.round(parseFloat("{{ i.cnt }}") / parseFloat("{{ cnt_total }}") *100) /100);
        </script>
    {% endfor %}
    {% for i in marketcap %}
        <script>
            cap_agg_by_industry.push(Math.round(parseFloat("{{ i.cap_per }}") *100) /100);
        </script>
    {% endfor %}
    <script>
        document.write("JavaScriptを使って出力しています。<BR>");
        document.write("{{ cnt_total }}"+"<BR>");
        document.write(industry1_name+"<BR>");
        document.write(cnt_agg_by_industry+"<BR>");
        document.write(cap_agg_by_industry);
        document.write("<BR>JavaScriptを使って出力しました。<BR>");
    </script>

    <h2>業種別割合分析</h2>
    <p>これで3年分ぐらいを重ねてみたい</p>
    <div class="radarChart1" style="display: inline-flex;"><h2>企業数</h2></div>
    <div class="radarChart2" style="display: inline-flex;"><h2>時価総額</h2></div>
    <script>
        var margin = { top: 50, right: 80, bottom: 50, left: 80 };
        var data1 = [
            {   
                name: 'cnt agg by industry',
                axes: [
                        {axis: industry1_name[0], value: cnt_agg_by_industry[0]},
                        {axis: industry1_name[1], value: cnt_agg_by_industry[1]},
                        {axis: industry1_name[2], value: cnt_agg_by_industry[2]},
                        {axis: industry1_name[3], value: cnt_agg_by_industry[3]},
                        {axis: industry1_name[4], value: cnt_agg_by_industry[4]},
                        {axis: industry1_name[5], value: cnt_agg_by_industry[5]},
                        {axis: industry1_name[6], value: cnt_agg_by_industry[6]},
                        {axis: industry1_name[7], value: cnt_agg_by_industry[7]},
                        {axis: industry1_name[8], value: cnt_agg_by_industry[8]},
                        {axis: industry1_name[9], value: cnt_agg_by_industry[9]},
                        {axis: industry1_name[10], value: cnt_agg_by_industry[10]}
                    ]
            }
        ];
        // data1.axes.push({axis: industry1_name, value: cnt_agg_by_industry});

        var data2 = [
            {   name: 'cap agg by industry',
                axes: [
                        {axis: industry1_name[0], value: cap_agg_by_industry[0]},
                        {axis: industry1_name[1], value: cap_agg_by_industry[1]},
                        {axis: industry1_name[2], value: cap_agg_by_industry[2]},
                        {axis: industry1_name[3], value: cap_agg_by_industry[3]},
                        {axis: industry1_name[4], value: cap_agg_by_industry[4]},
                        {axis: industry1_name[5], value: cap_agg_by_industry[5]},
                        {axis: industry1_name[6], value: cap_agg_by_industry[6]},
                        {axis: industry1_name[7], value: cap_agg_by_industry[7]},
                        {axis: industry1_name[8], value: cap_agg_by_industry[8]},
                        {axis: industry1_name[9], value: cap_agg_by_industry[9]},
                        {axis: industry1_name[10], value: cap_agg_by_industry[10]}
                    ]
            }
        ];

        var radarChartOptions = {
            w: 290,
            h: 350,
            margin: margin,
            levels: 5,
            roundStrokes: true,
            color: d3.scaleOrdinal().range(["#26AF32", "#762712"]),
            format: '.2f'
        };
        RadarChart(".radarChart1", data1, radarChartOptions);
        RadarChart(".radarChart2", data2, radarChartOptions);

    </script>

    <!-- 同業比較したいから、昇順keyつけてdbから出力 -->
    <!-- 上場日・主な事業・業種・ -->
    <h2>SABサイゴンビール</h2>
    <img src="{% static 'vietnam_research/chart/SAB.png' %}" alt="SAB">
    <h2>PHRフオックホア ゴム</h2>
    <img src="{% static 'vietnam_research/chart/PHR.png' %}" alt="PHR">
    <h2>GASペトロベトナムガス</h2>
    <img src="{% static 'vietnam_research/chart/GAS.png' %}" alt="GAS">
    <h2>PPCファーライ火力発電</h2>
    <img src="{% static 'vietnam_research/chart/PPC.png' %}" alt="PPC">
    <h2>FMCサオタ食品</h2>
    <img src="{% static 'vietnam_research/chart/FMC.png' %}" alt="FMC">
    <h2>VHCビンホアン（水産）</h2>
    <img src="{% static 'vietnam_research/chart/VHC.png' %}" alt="VHC">
    <h2>VNMビナミルク</h2>
    <img src="{% static 'vietnam_research/chart/VNM.png' %}" alt="VNM">

    <h2>PERとは</h2>
    <img src="{% static 'vietnam_research/images/PER.jpg' %}" alt="PER">

</body>
</html>